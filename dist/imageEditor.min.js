"use strict";var ImageEditor;ImageEditor=function(){function t(t){var n,e;null==t&&(t={}),(t.elt||t.pic)&&(e=this,e.config=t,n=e.config.elt,e.canvas=n.querySelector("canvas"),e.btLeft=n.querySelector(".bt-left"),e.btRight=n.querySelector(".bt-right"),e.btLess=n.querySelector(".bt-less"),e.btMore=n.querySelector(".bt-more"),e.btSave=n.querySelector(".bt-save"),e.doc=document,e.context=e.canvas.getContext("2d"),e.cnvW=e.canvas.width,e.cnvH=e.canvas.height,e.cnvRatio=e.canvas.height/e.canvas.width,e.cnvHalfW=e.cnvW/2,e.cnvHalfH=e.cnvH/2,e.cnvClearPx=-e.cnvW,e.cnvClearPy=-e.cnvH,e.cnvClearW=2*e.cnvW,e.cnvClearH=2*e.cnvH,e.currentAngle=0,e.newAngle=0,e.toRad=Math.PI/180,e.zoom=1.1,e.currentZoom=1,e.maxZoom=20,e.picture=new Image,e.picture.setAttribute("crossOrigin","anonymous"),e.picture.src=e.config.pic,e.picture.onload=function(){return e.init()})}return t.prototype.init=function(){var t;return t=this,t.btLeft.addEventListener("click",t.turnLeft.bind(t),!1),t.btRight.addEventListener("click",t.turnRight.bind(t),!1),t.btLess.addEventListener("click",t.zoomOut.bind(t),!1),t.btMore.addEventListener("click",t.zoomIn.bind(t),!1),t.btSave.addEventListener("click",t.saveImage.bind(t),!1),t.imgSettings(),t.context.translate(t.cnvHalfW,t.cnvHalfH),t.drawImage(),t.initialized=!0},t.prototype.update=function(t){var n;return n=this,n.picture=new Image,n.picture.setAttribute("crossOrigin","anonymous"),n.picture.src=t,n.imgSettings(),n.drawImage()},t.prototype.imgSettings=function(){var t,n;return n=this,n.picRatio=n.picture.height/n.picture.width,t=n.picRatio<1,n.imgW=t?n.cnvW/n.picRatio:n.cnvW,n.imgH=t?n.cnvH:n.cnvH*n.picRatio,n.imgPx=-n.imgW/2,n.imgPy=-n.imgH/2},t.prototype.turnLeft=function(){var t;return t=this,t.animation&&clearInterval(t.animation),t.newAngle-=90,t.rotation()},t.prototype.turnRight=function(){var t;return t=this,t.animation&&clearInterval(t.animation),t.newAngle+=90,t.rotation()},t.prototype.zoomOut=function(){var t;return t=this,t.currentZoom<=1?void 0:(t.imgW/=t.zoom,t.imgH/=t.zoom,t.currentZoom--,t.drawImage())},t.prototype.zoomIn=function(){var t;return t=this,t.currentZoom>t.maxZoom?void 0:(t.imgW*=t.zoom,t.imgH*=t.zoom,t.currentZoom++,t.drawImage())},t.prototype.rotation=function(){var t,n;return n=this,n.animating=!0,t=n.currentAngle<n.newAngle,n.animation=setInterval(function(){return t?n.currentAngle+=2:n.currentAngle-=2,n.context.rotate(2*(t?n.toRad:-n.toRad)),n.drawImage(),n.currentAngle===n.newAngle?(clearInterval(n.animation),n.animating=!1):void 0},1)},t.prototype.drawImage=function(){var t;return t=this,t.context.clearRect(t.cnvClearPx,t.cnvClearPy,t.cnvClearW,t.cnvClearH),t.context.drawImage(t.picture,t.imgPx,t.imgPy,t.imgW,t.imgH)},t.prototype.saveImage=function(){var t;return t=this,console.log("saveImage")},t}();